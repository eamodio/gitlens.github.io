!function(){"use strict";var t,e;!function(t){t.on=function(t,e,s,i,o){let n=!1;if("string"==typeof t){const a=(null!=o?o:document).querySelectorAll(t);for(const t of a)t.addEventListener(e,s,null!=i&&i);return{dispose:()=>{if(!n){n=!0;for(const t of a)t.removeEventListener(e,s,null!=i&&i)}}}}return t.addEventListener(e,s,null!=i&&i),{dispose:()=>{n||(n=!0,t.removeEventListener(e,s,null!=i&&i))}}},t.$=function(t){return document.querySelectorAll(t)}}(t||(t={})),function(t){t.clear=function(){localStorage.clear()},t.get=function(t){const e=localStorage.getItem(t);if(null!=e)return JSON.parse(e)},t.remove=function(t){localStorage.removeItem(t)},t.set=function(t,e){localStorage.setItem(t,JSON.stringify(e))}}(e||(e={}));class s{constructor(e){this.name=e,this.activeVersion="11.5.0",this.versions=new Map;const s=this;t.on(`[data-action="${this.name}"]`,"click",this.onButtonClicked.bind(this)),t.on(`[data-view="${this.name}"] [data-action="scrollTo"]`,"click",(function(t){s.onScrollToClicked(this,t)})),t.on(`[data-view="${this.name}"] [data-action="showVersion"]`,"click",(function(t){s.onShowVersionClicked(this,t)}));const i=t.$(`.section[data-view="${this.name}"]`)[0];this.classes=["is-section",`is-section--${this.name}`];const o=i.dataset.classes;null!=o&&this.classes.push(...o.split(" ")),this.observer=new IntersectionObserver(this.onObserver.bind(this),{rootMargin:"0px 0px 0px 0px"});for(const t of document.querySelectorAll(".changelog__list>.changelog__list-item--version[id]"))this.versions.set(t.id,!1),this.observer.observe(t)}get hash(){return`#${this.name}`}activate(t,e=!1){document.body.classList.add(...this.classes)}deactivate(){document.body.classList.remove(...this.classes)}getHash(t){return`${this.hash}${t?`${t.startsWith("/")?t:`/${t}`}`:""}`.toLowerCase()}matchesPath(t){var e;return(null===(e=document.location.hash)||void 0===e?void 0:e.toLowerCase())===this.getHash(t)}setPath(t){document.location.hash=this.getHash(t)}onButtonClicked(t){var e;(null===(e=document.location.hash)||void 0===e?void 0:e.startsWith(this.hash))?document.location.hash="":this.setPath()}onObserver(t,e){for(const e of t)this.versions.set(e.target.id,e.isIntersecting);let s;for(const[t,e]of this.versions.entries())if(e){s=t;break}if(void 0===s){if(1!==t.length)return;const e=t[0];if(null==e.boundingClientRect||null==e.rootBounds)return;if(s=e.target.id,e.boundingClientRect.top>=e.rootBounds.bottom){const t=[...this.versions.keys()],e=t.indexOf(s);if(e<=0)return;s=t[e-1]}}this.activeVersion!==s?(void 0!==this.activeVersion&&this.toggleVersionLink(this.activeVersion,!1),this.activeVersion=s,this.toggleVersionLink(this.activeVersion,!0)):this.toggleVersionLink(this.activeVersion,!0)}onScrollToClicked(e,s){const i=e.dataset.scrollTo,o=document.getElementById(i),n=o.closest("section[id]"),a=t.$(`[data-target="patches"][data-version="${n.dataset.version}"]`)[0].getBoundingClientRect().height+8,c=n.getBoundingClientRect().top,l=o.getBoundingClientRect().top-c-a;n.parentElement.scrollTo({top:l,behavior:"smooth"})}onShowVersionClicked(e,s){t.$(`[data-view="${this.name}"]`)[0].dataset.version=e.dataset.version}toggleVersionLink(t,e){const s=document.querySelector(`a[data-action="scrollTo"][data-scroll-to="${t}"]`);null!=s&&s.classList.toggle("active",e)}}new class{constructor(){this.activeView="",this._sectionCompleteHandle=0,this.views=[];for(const e of t.$(".section[data-view]")){const t=e.dataset.view;null!=t&&this.views.push(new s(t))}t.on('[data-action="back"]',"click",this.onBackButtonClicked.bind(this)),t.on(".changelog__image","click",(function(){this.classList.toggle("expand",!this.classList.contains("expand"))})),window.addEventListener("hashchange",this.onHashChanged.bind(this),!1);const[e,i]=this.getHashAndPaths();this.switchView(e,i,!0)}switchView(t,e,s=!1){window.clearTimeout(this._sectionCompleteHandle),this._sectionCompleteHandle=0;const i=this.activeView;switch(t){case"":if(this.activeView="",i!==this.activeView){const t=this.views.find((t=>t.name===i));null!=t&&t.deactivate()}document.body.classList.toggle("complete",s),s||(document.location.hash="");break;default:{const o=this.views.find((e=>e.name===t));if(null==o)return void this.switchView("",[],!1);if(this.activeView=t,i!==this.activeView){const t=this.views.find((t=>t.name===i));null!=t&&t.deactivate()}o.activate(e,s),document.body.classList.toggle("complete",s),s||(this._sectionCompleteHandle=window.setTimeout((()=>document.body.classList.add("complete")),1e3));break}}s&&setTimeout((()=>document.body.classList.remove("preload")),1)}onBackButtonClicked(t){document.location.hash=""}onHashChanged(t){const[e,s]=this.getHashAndPaths();this.redirect(e,s)||this.switchView(e,s)}getHashAndPaths(){var t;let e=null===(t=document.location.hash)||void 0===t?void 0:t.substring(1),s=[];return e&&([e,...s]=e.split("/")),[e,s]}redirect(t,e){return"support-gitlens"===t&&(document.location.hash="#sponsor",!0)}}}();
//# sourceMappingURL=main.js.map